<div ng-controller="CollectionController as CC" ng-init="CC.init()">
	<a-module>
		<a-container>
			<a-header>
				<a-row>
					<a-col size="6">
						<h4>Collection Report</h4>
					</a-col>
					<a-col size="6">
						<o-dropdown-filter ng-model="CC.Active" show-section="false" show-sem="false" class="pull-right" >
							<li class="dropdown-header" ng-show="CC.ActiveOpt.id=='daily'">MONTHS</li>
							<li class="dropdown-input" ng-show="CC.ActiveOpt.id=='daily'">
								<div class="btn-group">
									<a-button>
										<span ng-if="CC.ActiveMonth">{{CC.ActiveMonth.month}}</span>
										<span ng-if="!CC.ActiveMonth"><a-glyph icon="exclamation-sign"></a-glyph> Not Available</span>
									</a-button>
									<a-button opt-class="btn-nav" ng-click="CC.navigateMonth('prev')" ng-disabled="CC.index==0||!CC.Months">
										<span class="glyphicon glyphicon-chevron-left"></span>
									</a-button>
									<a-button opt-class="btn-nav" ng-click="CC.navigateMonth('next')" ng-disabled="CC.index==(CC.Months.length-1)||!CC.Months">
										<span class="glyphicon glyphicon-chevron-right"></span>
									</a-button>
								</div>
							</li>
						</o-dropdown-filter>
					</a-col>
				</a-row>
			</a-header>
			<a-header style="z-index:0">
				<a-row>
					<a-col size="5">
						<ul class="nav nav-pills">
							<li ng-repeat="opt in CC.Options" 
							ng-click="CC.setActOption(opt)" 
							ng-class="{active:CC.ActiveOpt.id===(opt.id)}">
								<a>{{opt.desc}}</a>
							</li>
						</ul>
					</a-col>
					<a-col size="3">
						<div class="input-group">
							<span class="input-group-addon">From: </span>
							<input type="date" class="input-md form-control" ng-change="CC.ChangeDate()" ng-model="CC.date_from" min="{{cc.date_from | date:'yyyy-MM-dd'}}" />
						</div>
					</a-col>
					<a-col size="2">
						<div class="input-group">
							<span class="input-group-addon">To: </span>
							<input type="date" class="input-md form-control" ng-change="CC.ChangeDate()" ng-model="CC.date_to" />
						</div>
					</a-col>
					<a-col size="2">
						<button class="btn btn-primary pull-right" ng-click="CC.LoadReport()" ng-disabled="!CC.date_from||!CC.date_to" ng-show="!CC.Loaded">Load</button>
						<button class="btn btn-primary pull-right" ng-disabled="!CC.date_from||!CC.date_to" ng-show="CC.Loaded">Print</button>
					</a-col>
				</a-row>
			</a-header>
			<a-canvas>
				<a-content ng-show="CC.Collections">
					<a-row>
						<a-col size="6">
							<img src="webroot/img/pie.svg" alt="" style="margin: 0.5rem 6rem;width: 21rem;margin-bottom: 1.5rem;">
						</a-col>
						<a-col size="3">
							<div class="amount amount-total">
								<label for="">Total Receivable</label>
								<h3>
									<div class="amount total peso">{{CC.Collections.total_receivables | currency}}</div>
								</h3>
							</div>
							<div class="amount amount-total">
								<label for="">Total Subsidies</label>
								<h3>
									<div class="amount total peso">{{CC.Collections.total_subsidies | currency}}</div>
								</h3>
							</div>
							<div class="amount amount-total">
								<label for="">Net Receivables</label>
								<h3>
									<div class="amount total peso">{{CC.Collections.total_receivables-CC.Collections.total_subsidies | currency}}</div>
								</h3>
							</div>
						</a-col>
						<a-col size="3">
							<div class="amount amount-total">
								<label for="">Collection Forwarded</label>
								<h3>
									<div class="amount total peso">{{CC.Collections.collection_forwarded | currency}}</div>
								</h3>
							</div>
							<div class="amount amount-total">
								<label for="">Beginning Balance</label>
								<h3>
									<div class="amount total peso">{{CC.Collections.net_receivables | currency}}</div>
								</h3>
							</div>
						</a-col>
					</a-row>
					
					<a-row>
						<a-col>
							<!-- <a-table headers="CC.Headers" props="CC.Props" data="CC.Collections.monthly_collections" ></a-table> -->
							<table class="table table-bordered table-condensed">
								<thead>
									<tr ng-show="CC.ActiveOpt.id=='month'">
										<th>Month</th>
										<th>Details</th>
										<th>Collections</th>
										<th>Balance</th>
									</tr>
									<tr ng-show="CC.ActiveOpt.id=='daily'">
										<th>Date</th>
										<th>Month</th>
										<th>Details</th>
										<th>Collections</th>
										<th>Balance</th>
									</tr>
								</thead>
								<tbody>
									<tr ng-show="CC.ActiveOpt.id=='month'" ng-repeat="col in CC.Collections.collections">
										<td>{{col.month}}</td>
										<td>{{col.details}}</td>
										<td class="amount total peso">{{col.collection | currency}}</td>
										<td class="amount total peso">{{col.balance | currency}}</td>
									</tr>
									<tr ng-show="CC.ActiveOpt.id=='daily'" ng-repeat="col in CC.Collections.collections">
										<td>{{col.date}}</td>
										<td>{{col.day}}</td>
										<td>{{col.description}}</td>
										<td class="amount total peso">{{col.collection | currency}}</td>
										<td class="amount total peso">{{col.balance | currency}}</td>
									</tr>
								</tbody>
							</table>
						</a-col>
					</a-row>
				</a-content>
				<a-content ng-show="!CC.Collections&&!CC.Loading" style="height: 100%">
					<div class="empty-state">
						<div class="well">
							<div class="empty-state-icon text-center">
								<i class="glyphicon glyphicon-calendar"></i>
							</div>
							<h4>Select date range then load.</h4>
						</div>
					</div>
				</a-content>
				<a-content ng-show="CC.Loading" style="height: 100%">
					<div class="empty-state">
						<div class="well text-center">
							<div class="empty-state-icon text-center">
								<i class="glyphicon glyphicon-refresh spin"></i>
							</div>
							<h4>Loading collection reports...</h4>
						</div>
					</div>
				</a-content>
				</a-content>
			</a-canvas>
		</a-container>
	</a-module>
</div>